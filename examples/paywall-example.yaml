# Comprehensive paywall enforcement example
# This configuration demonstrates how to set up inbound paywall enforcement
# for different types of MCP servers with various pricing strategies

name: "Paywall Gateway Example"
version: "1.0.0"
description: "Example gateway configuration with comprehensive paywall enforcement"

servers:
  # Premium AI service with high-value tools
  premium-ai:
    enabled: true
    namespace: "ai"
    transport:
      type: http
      url: "https://api.premium-ai.com/mcp"
      headers:
        Authorization: "Bearer ${PREMIUM_AI_API_KEY}"
    paywall:
      enabled: true
      wallet:
        type: evm
        network: base                    # Use base mainnet for production
        privateKeyEnv: PREMIUM_AI_WALLET_KEY
      maxValueMicroUSDC: "1000000"      # 1.00 USDC max per request
      pricing:
        defaultPriceMicroUSDC: "10000"   # 0.01 USDC default price
        perTool:
          # High-value AI tools
          gpt4-turbo-analysis: "100000"  # 0.10 USDC
          claude-opus-reasoning: "80000" # 0.08 USDC
          dall-e-3-generation: "50000"  # 0.05 USDC
          code-review-expert: "30000"   # 0.03 USDC
          # Moderate-value tools
          gpt3-5-chat: "5000"           # 0.005 USDC
          basic-translation: "2000"     # 0.002 USDC
          # Free tools for trial
          health-check: "0"             # Free
          get-capabilities: "0"         # Free
        perResource:
          # Model access pricing
          "model://gpt-4-turbo": "150000"    # 0.15 USDC
          "model://claude-3-opus": "120000"  # 0.12 USDC
          "model://dall-e-3": "60000"        # 0.06 USDC
          "model://gpt-3.5-turbo": "10000"   # 0.01 USDC
          # Dataset access
          "dataset://premium-training": "200000"  # 0.20 USDC
          "dataset://public-samples": "0"         # Free samples
        perPrompt:
          # Expert prompt templates
          expert-code-review: "25000"    # 0.025 USDC
          creative-writing: "15000"      # 0.015 USDC
          data-analysis: "20000"         # 0.02 USDC
          basic-chat: "1000"             # 0.001 USDC
      policy:
        freeList: true                   # Allow free discovery of capabilities
        requireForCalls: true            # Require payment for actual usage

  # Data service with resource-focused pricing
  data-premium:
    enabled: true
    namespace: "data"
    transport:
      type: sse
      sseUrl: "https://stream.data-service.com/sse"
      postUrl: "https://api.data-service.com/mcp"
      headers:
        X-API-Key: "${DATA_SERVICE_API_KEY}"
    paywall:
      enabled: true
      wallet:
        type: evm
        network: base-sepolia           # Use testnet for development
        privateKeyEnv: DATA_SERVICE_WALLET_KEY
      maxValueMicroUSDC: "500000"      # 0.50 USDC max per request
      pricing:
        defaultPriceMicroUSDC: "5000"   # 0.005 USDC default
        perTool:
          fetch-market-data: "10000"    # 0.01 USDC
          analyze-trends: "25000"       # 0.025 USDC
          generate-report: "15000"      # 0.015 USDC
          export-csv: "3000"            # 0.003 USDC
        perResource:
          # Real-time data feeds
          "feed://stock-prices": "20000"      # 0.02 USDC
          "feed://crypto-prices": "15000"     # 0.015 USDC
          "feed://forex-rates": "10000"       # 0.01 USDC
          "feed://commodities": "12000"       # 0.012 USDC
          # Historical data
          "history://stocks/1y": "50000"      # 0.05 USDC
          "history://crypto/1y": "40000"      # 0.04 USDC
          "history://forex/1m": "8000"        # 0.008 USDC
          # Free tier data
          "sample://demo-data": "0"           # Free samples
        perPrompt:
          market-analysis: "30000"       # 0.03 USDC
          risk-assessment: "25000"       # 0.025 USDC
          trend-prediction: "35000"      # 0.035 USDC
      policy:
        freeList: true
        requireForCalls: true

  # Utility service with flat low pricing
  utils-service:
    enabled: true
    namespace: "utils"
    transport:
      type: stdio
      command: "node"
      args: ["./utils-mcp-server.js"]
    paywall:
      enabled: true
      wallet:
        type: evm
        network: base-sepolia
        privateKeyEnv: UTILS_WALLET_KEY
      maxValueMicroUSDC: "10000"       # 0.01 USDC max (low-cost service)
      pricing:
        defaultPriceMicroUSDC: "100"    # 0.0001 USDC - very cheap
        # No per-item pricing - everything uses default flat rate
      policy:
        freeList: true
        requireForCalls: true

  # Freemium service - some paid, some free
  freemium-service:
    enabled: true
    namespace: "freemium"
    transport:
      type: websocket
      url: "wss://api.freemium-service.com/mcp"
    paywall:
      enabled: true
      wallet:
        type: evm
        network: base-sepolia
        privateKeyEnv: FREEMIUM_WALLET_KEY
      maxValueMicroUSDC: "100000"      # 0.10 USDC max
      pricing:
        defaultPriceMicroUSDC: "0"      # Free by default
        perTool:
          # Premium tools require payment
          premium-feature: "50000"      # 0.05 USDC
          advanced-analysis: "25000"    # 0.025 USDC
          # Basic tools are free (explicitly set to 0)
          basic-search: "0"
          simple-convert: "0"
          help: "0"
        perResource:
          "premium://advanced-data": "30000"  # 0.03 USDC
          "basic://public-data": "0"          # Free
      policy:
        freeList: true
        requireForCalls: true

  # Completely free service for comparison
  free-service:
    enabled: true
    namespace: "free"
    transport:
      type: stdio
      command: "npx"
      args: ["-y", "free-mcp-server"]
    # No paywall configuration - completely free

settings:
  enableToolConflictResolution: true
  enableResourceConflictResolution: true
  enablePromptConflictResolution: true
  logLevel: info
  maxConcurrentConnections: 20
  healthCheckInterval: 30000

# Environment variables needed:
# PREMIUM_AI_API_KEY=your-premium-ai-api-key
# PREMIUM_AI_WALLET_KEY=0x1234...your-evm-private-key
# DATA_SERVICE_API_KEY=your-data-service-key
# DATA_SERVICE_WALLET_KEY=0x5678...your-evm-private-key
# UTILS_WALLET_KEY=0x9abc...your-evm-private-key
# FREEMIUM_WALLET_KEY=0xdef0...your-evm-private-key
